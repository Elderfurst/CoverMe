@{
    ViewData["Title"] = "CoverMe";
}

<!--Include CDN links for Select2 -->
<link href="https://cdn.jsdelivr.net/npm/select2@4.0.12/dist/css/select2.min.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/select2@4.0.12/dist/js/select2.min.js"></script>

<div class="text-center">
    <h1 class="display-4"><span class="oi oi-rain"></span> CoverMe</h1>
</div>

<div>
    <select class="address-search" style="width: 100%"></select>
</div>

<script>
    $(document).ready(function () {
        $('.address-search').select2({
            ajax: {
                delay: 250, // Wait 250 milliseconds before sending the request
                url: '/Location/Search',
                dataType: 'json',
                data: function (params) {
                    return {
                        query: params.term
                    };
                },
                processResults: function (data) {
                    console.log(data);
                    return {
                        results: data
                    };
                }
            },
            placeHolder: 'Search for an address to use',
            minimumInputLength: 3,
            templateResult: formatLocation,
            templateSelection: formatLocationSelection
        });
    });

    function formatLocation(location) {
        if (location.loading) {
            return location.text;
        }

        return location.fullAddress;
    }

    function formatLocationSelection(location) {
        console.log("format location selection");
        console.log(location);
        return {
            lat: location.latitude,
            lon: location.longitude
        };
    }
</script>


